# https://codefresh.io/docs/docs/codefresh-yaml/what-is-the-codefresh-yaml/#using-yaml-anchors-to-avoid-repetition

version: '1.0'
steps:
  Hello: &hello
    title: Hello world
    image: gcc
    commands:
      - echo "${HELLO} ${WORLD}"
    environment: &hello_envs
      - HELLO=hello
    when: &skip_condition
      condition:
        all:
          noSkipCiInCommitMessage: |
            includes(lower("${{CF_COMMIT_MESSAGE}}"), "[ci skip]") == false && includes(lower("${{CF_COMMIT_MESSAGE}}"), "[skip ci]") == false
          noSkipCiInCommitMessage2: |
            includes(lower("${{CF_COMMIT_MESSAGE}}"), "[skip codefresh]") == false

  Hello2:
    title: Hello world 2
    image: gcc
    commands:
      - echo "${HELLO} ${HELLO}"
    environment: *hello_envs
    when: *skip_condition

  Hello3:
    <<: *hello
    title: Hello world 3
    environment:
      - WORLD=world

  Hello4:
    <<: *hello
    title: Hello world 4
    environment:
      - *hello_envs
      - WORLD=world
